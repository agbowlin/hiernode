var HierNodeLib=function(){return{HierNode:function(c){c=void 0===c?{}:c;c._hnPrevNode=null;c._hnNextNode=null;c._hnIndent=0;c.PrevNode=function(){return this._hnPrevNode};c.NextNode=function(){return this._hnNextNode};c.Indent=function(){return this._hnIndent};c.CloneObject=function(a){var b;if(!a||"object"!=typeof a)return a;if(a instanceof Date)return b=new Date,b.setTime(a.getTime()),b;if(a instanceof Array){b=[];for(var d=0,c=a.length;d<c;d++)b[d]=this.CloneObject(a[d]);return b}if(a instanceof
Object){b={};for(d in a)a.hasOwnProperty(d)&&(b[d]=this.CloneObject(a[d]));return b}throw Error("Unable to copy obj! Its type isn't supported.");};c.CloneNode=function(){var a=this._hnPrevNode,b=this._hnNextNode;this._hnNextNode=this._hnPrevNode=null;var d=this.CloneObject(this);this._hnPrevNode=a;this._hnNextNode=b;return d};c.FindRelative=function(a){for(var b=this._hnPrevNode,d=this._hnNextNode,c=this,e=this,f=null;;){if("PrevNode"===a)return this._hnPrevNode;if("NextNode"===a)return this._hnNextNode;
if("FirstNode"===a){if(null===b)return this;if(null===b._hnPrevNode)return b;b=b._hnPrevNode}else if("LastNode"===a){if(null===d)return this;if(null===d._hnNextNode)return d;d=d._hnNextNode}else if("RootNode"===a){if(null===b)return c;b._hnIndent<c._hnIndent&&(c=b);b=b._hnPrevNode}else if("ParentNode"===a){if(null===b)break;if(b._hnIndent<this._hnIndent)return b;b=b._hnPrevNode}else if("PrevSibNode"===a){if(null===b)break;if(b._hnIndent<this._hnIndent)break;if(b._hnIndent===this._hnIndent)return b;
b=b._hnPrevNode}else if("NextSibNode"===a){if(null===d)break;if(d._hnIndent<this._hnIndent)break;if(d._hnIndent===this._hnIndent)return d;d=d._hnNextNode}else if("FirstSibNode"===a){if(null===b||b._hnIndent<this._hnIndent)return e;b._hnIndent===this._hnIndent&&(e=b);b=b._hnPrevNode}else if("LastSibNode"===a){if(null===d||d._hnIndent<this._hnIndent)return e;d._hnIndent===this._hnIndent&&(e=d);d=d._hnNextNode}else if("FirstChildNode"===a){if(null===d)break;if(d._hnIndent<=this._hnIndent)break;if(d._hnIndent===
this._hnIndent+1)return d;d=d._hnNextNode}else if("LastChildNode"===a){if(null===d||d._hnIndent<=this._hnIndent)return f;d._hnIndent===this._hnIndent+1&&(f=d);d=d._hnNextNode}else if("FirstDescNode"===a){if(d&&d._hnIndent>this._hnIndent)return d;break}else if("LastDescNode"===a){if(null===d||d._hnIndent<=this._hnIndent)return f;d._hnIndent>this._hnIndent&&(f=d);d=d._hnNextNode}else break}return null};c.FindFirst=function(){return this.FindRelative("FirstNode")};c.FindLast=function(){return this.FindRelative("LastNode")};
c.FindRoot=function(){return this.FindRelative("RootNode")};c.FindParent=function(){return this.FindRelative("ParentNode")};c.FindPrevSibling=function(){return this.FindRelative("PrevSibNode")};c.FindNextSibling=function(){return this.FindRelative("NextSibNode")};c.FindFirstSibling=function(){return this.FindRelative("FirstSibNode")};c.FindLastSibling=function(){return this.FindRelative("LastSibNode")};c.FindFirstChild=function(){return this.FindRelative("FirstChildNode")};c.FindLastChild=function(){return this.FindRelative("LastChildNode")};
c.FindFirstDescendent=function(){return this.FindRelative("FirstDescNode")};c.FindLastDescendent=function(){return this.FindRelative("LastDescNode")};c.VisitNodes=function(a,b,d){d=void 0===d?!1:d;var c,e,f=null;if("AllNodes"==b)c="FirstNode",e="NextNode";else if("PrevNodes"==b)e=c="PrevNode";else if("NextNodes"==b)e=c="NextNode";else if("ParentNodes"==b)e=c="ParentNode";else if("SiblingNodes"==b)c="FirstSibNode",e="NextSibNode";else if("PrevSibNodes"==b)e=c="PrevSibNode";else if("NextSibNodes"==
b)e=c="NextSibNode";else if("ChildNodes"==b)c="FirstChildNode",e="NextSibNode",f=!0;else if("DecendentNodes"==b)c="FirstChildNode",e="NextNode",f=!0;else throw Error("Unknown VisitationType ["+b+"].");if(a.Init&&!a.Init(this,a,b,d)||d&&!a.Visit(this))return a;for(b=this.FindRelative(c);b&&!(f&&b._hnIndent<=this._hnIndent)&&a.Visit(b);)b=b.FindRelative(e);return a};c.VisitAll=function(a){return this.VisitNodes(a,"PrevNodes",!1)};c.VisitPrevious=function(a,b){return this.VisitNodes(a,"PrevNodes")};
c.VisitNext=function(a,b){return this.VisitNodes(a,"NextNodes")};c.VisitParents=function(a,b){return this.VisitNodes(a,"ParentNodes")};c.VisitSiblings=function(a){return this.VisitNodes(a,"SiblingNodes",!1)};c.VisitPreviousSiblings=function(a,b){return this.VisitNodes(a,"PrevSibNodes")};c.VisitNextSiblings=function(a,b){return this.VisitNodes(a,"NextSibNodes")};c.VisitChildren=function(a,b){return this.VisitNodes(a,"ChildNodes")};c.VisitDescendents=function(a,b){return this.VisitNodes(a,"DecendentNodes")};
c.ChildCount=function(){return this.VisitNodes(new HierNodeLib.CountingVisitor,"ChildNodes",!1).Count};c.Children=function(a){a=void 0===a?!1:a;return this.VisitNodes(new HierNodeLib.CollectingVisitor,"ChildNodes",a).Nodes};c.Child=function(a){return this.VisitNodes(new HierNodeLib.IndexSelectorVisitor(a),"ChildNodes",!1).Node};c.SearchChildren=function(a,b,d){d=void 0===d?!1:d;return this.VisitNodes(new HierNodeLib.PropertySearchVisitor(a,b),"ChildNodes",d).Nodes};c.SearchFirstChild=function(a,b,
d){d=void 0===d?!1:d;return this.VisitNodes(new HierNodeLib.PropertySearchFirstVisitor(a,b),"ChildNodes",d).Node};c.DescendentCount=function(){return this.VisitNodes(new HierNodeLib.CountingVisitor,"DecendentNodes",!1).Count};c.Descendents=function(a){a=void 0===a?!1:a;return this.VisitNodes(new HierNodeLib.CollectingVisitor,"DecendentNodes",a).Nodes};c.SearchDescendents=function(a,b,d){d=void 0===d?!1:d;return this.VisitNodes(new HierNodeLib.PropertySearchVisitor(a,b),"DecendentNodes",d).Nodes};
c.SearchFirstDescendent=function(a,b,d){d=void 0===d?!1:d;return this.VisitNodes(new HierNodeLib.PropertySearchFirstVisitor(a,b),"DecendentNodes",d).Node};c.Link=function(a,b){if(this._hnPrevNode||this._hnNextNode)throw Error("This node is already linked.");this._hnPrevNode=a;this._hnNextNode=b;this._hnPrevNode&&(this._hnPrevNode._hnNextNode=this);this._hnNextNode&&(this._hnNextNode._hnPrevNode=this);return this};c.Unlink=function(){var a=this._hnPrevNode,b=this._hnNextNode;this._hnNextNode=this._hnPrevNode=
null;a&&(a._hnNextNode=b);b&&(b._hnPrevNode=a);return this};c.AddChild=function(a,b){a=a?a:{};b=void 0===b?-1:b;a=HierNodeLib.HierNode(a);for(var d=this,c=this._hnNextNode;c;){if(c._hnIndent===this._hnIndent+1){if(!b)return a.Link(d,c),a._hnIndent=this._hnIndent+1,a;b--}else if(c._hnIndent<=this._hnIndent)return a.Link(d,c),a._hnIndent=this._hnIndent+1,a;d=c;c=c._hnNextNode}a.Link(d,null);a._hnIndent=this._hnIndent+1;return a};c.AddChildren=function(a){if(!a.length)return this;for(var b=this,d=this,
c=this._hnIndent,e,f=0;f<a.length;f++){e=a[f]._hnIndent||0;e==c?(b=b.FindRelative("ParentNode"),c=b._hnIndent):e>c?(b=d,c=d._hnIndent):e<c&&(b=b.FindRelative("ParentNode"),c=b._hnIndent);if(!b)break;d=b.AddChild(a[f])}return this};c.RemoveChild=function(a){a=this.VisitNodes(new HierNodeLib.IndexSelectorVisitor(a),"ChildNodes").Node;if(!a)return null;var b=a.FindRelative("LastDescNode");if(b){if(a._hnPrevNode._hnNextNode=b._hnNextNode)b._hnNextNode._hnPrevNode=a._hnPrevNode}else a._hnPrevNode._hnNextNode=
null;a._hnPrevNode=null;a._hnNextNode=null;return a};c.RemoveChildren=function(){var a=this.FindRelative("LastDescNode");a&&(a._hnPrevNode=this,this._hnNextNode=a._hnNextNode)&&(a._hnNextNode._hnPrevNode=this)};c.TextGraph=function(a,b,c,g){b=void 0===b?!1:b;c=void 0===c?"\t":c;g=void 0===g?"\n":g;var e="";b&&(e=this[a]);for(var f=this._hnIndent,h=this._hnNextNode;h&&!(h._hnIndent<=f);){var e=e+g,k=1;for(b||k++;k<=h._hnIndent-f;k++)e+=c;e+=h[a];h=h._hnNextNode}return e};c.TextPath=function(a,b,c){b=
void 0===b?!0:b;c=void 0===c?"/":c;var g=this.VisitNodes(new HierNodeLib.CollectingVisitor,"ParentNodes",!0).Nodes,e=g.length-1;b||e--;b="";for(var f=0;f<=e;f++)b=c+g[f][a]+b;return b};c.FindPath=function(a,b,c,g){g=void 0===g?"/":g;if(!g)return this;for(c=this;c&&0<a.length;){for(;!a.indexOf(g);)a=a.substr(g.length);if(0<a.length){var e=a.indexOf(g);0>e&&(e=a.length);var f=a.substr(0,e);a=a.substr(e);c=c.VisitNodes(new HierNodeLib.PropertySearchFirstVisitor(b,f),"ChildNodes").Node}}return c};return c},
TextNode:function(c){c=HierNodeLib.HierNode({Text:void 0===c?"":c});c.AddChildText=function(a,b){b=void 0===b?-1:b;return this.AddChild(HierNodeLib.TextNode(void 0===a?"":a),b)};return c},NullVisitor:function(){this.Init=function(c,a,b,d){return!0};this.Visit=function(c){return!0}},CountingVisitor:function(){this.Count=0;this.Visit=function(c){this.Count++;return!0}},CollectingVisitor:function(c){c=void 0===c?!1:c;this.Nodes=[];this.RootIndent=0;this.Init=function(a,b,c,g){this.RootIndent=a._hnIndent;
return!0};this.Visit=function(a){var b=a;c&&(b=b.CloneNode(),b=HierNodeLib.HierNode(b),b._hnIndent=a._hnIndent-this.RootIndent);this.Nodes.push(b);return!0}},IndexSelectorVisitor:function(c){this.Index=c;this.Count=0;this.Node=null;this.Visit=function(a){this.Count++;return this.Count>this.Index?(this.Node=a,!1):!0}},PropertySearchVisitor:function(c,a,b){this.PropertyName=c;this.PropertyValue=a;this.MaxResults=void 0===b?0:b;this.Nodes=[];this.Visit=function(b){if(this.MaxResults&&this.Nodes.length>=
this.MaxResults)return!1;b[c]===a&&this.Nodes.push(b);return!0}},PropertySearchFirstVisitor:function(c,a){this.PropertyName=c;this.PropertyValue=a;this.Node=null;this.Visit=function(b){return b[c]==a?(this.Node=b,!1):!0}}}}();window&&(window.HierNodeLib=HierNodeLib,window.HierNode=HierNodeLib.HierNode,window.TextNode=HierNodeLib.TextNode);
