var HierNodeLib=function(){function a(b,a){for(var c=b._hnPrevNode,d=b._hnNextNode,h=b,e=b,g=null;;){if(a===f.PrevNode)return b._hnPrevNode;if(a===f.NextNode)return b._hnNextNode;if(a===f.FirstNode){if(null===c)return b;if(null===c._hnPrevNode)return c;c=c._hnPrevNode}else if(a===f.LastNode){if(null===d)return b;if(null===d._hnNextNode)return d;d=d._hnNextNode}else if(a===f.RootNode){if(null===c)return h;c._hnIndent<h._hnIndent&&(h=c);c=c._hnPrevNode}else if(a===f.ParentNode){if(null===c)break;if(c._hnIndent<
b._hnIndent)return c;c=c._hnPrevNode}else if(a===f.PrevSibNode){if(null===c)break;if(c._hnIndent<b._hnIndent)break;if(c._hnIndent===b._hnIndent)return c;c=c._hnPrevNode}else if(a===f.NextSibNode){if(null===d)break;if(d._hnIndent<b._hnIndent)break;if(d._hnIndent===b._hnIndent)return d;d=d._hnNextNode}else if(a===f.FirstSibNode){if(null===c||c._hnIndent<b._hnIndent)return e;c._hnIndent===b._hnIndent&&(e=c);c=c._hnPrevNode}else if(a===f.LastSibNode){if(null===d||d._hnIndent<b._hnIndent)return e;d._hnIndent===
b._hnIndent&&(e=d);d=d._hnNextNode}else if(a===f.FirstChildNode){if(null===d)break;if(d._hnIndent<=b._hnIndent)break;if(d._hnIndent===b._hnIndent+1)return d;d=d._hnNextNode}else if(a===f.LastChildNode){if(null===d||d._hnIndent<=b._hnIndent)return g;d._hnIndent===b._hnIndent+1&&(g=d);d=d._hnNextNode}else if(a===f.FirstDescNode){if(d&&d._hnIndent>b._hnIndent)return d;break}else if(a===f.LastDescNode){if(null===d||d._hnIndent<=b._hnIndent)return g;d._hnIndent>b._hnIndent&&(g=d);d=d._hnNextNode}else break}return null}
function h(b){var a=b._hnPrevNode,c=b._hnNextNode;b._hnPrevNode=null;b._hnNextNode=null;a&&(a._hnNextNode=c);c&&(c._hnPrevNode=a);return b}function e(b,a){var c=HierNodeLib.VisitNodes(b,new HierNodeLib.IndexSelectorVisitor(a),HierNodeLib.VisitationTypes.ChildNodes).Node;c&&h(c);return c}var f={PrevNode:"PrevNode",NextNode:"NextNode",FirstNode:"FirstNode",LastNode:"LastNode",RootNode:"RootNode",ParentNode:"ParentNode",PrevSibNode:"PrevSibNode",NextSibNode:"NextSibNode",FirstSibNode:"FirstSibNode",
LastSibNode:"LastSibNode",FirstChildNode:"FirstChildNode",LastChildNode:"LastChildNode",FirstDescNode:"FirstDescNode",LastDescNode:"LastDescNode"},k={AllNodes:"AllNodes",PrevNodes:"PrevNodes",NextNodes:"NextNodes",ParentNodes:"ParentNodes",SiblingNodes:"SiblingNodes",PrevSibNodes:"PrevSibNodes",NextSibNodes:"NextSibNodes",ChildNodes:"ChildNodes",DecendentNodes:"DecendentNodes"},g={InitNode:function(b){b._hnPrevNode=null;b._hnNextNode=null;b._hnIndent=0;return b},PrevNode:function(b){return b._hnPrevNode},
NextNode:function(b){return b._hnNextNode},Indent:function(b){return b._hnIndent}};g.RelationshipTypes=f;g.FindRelative=a;g.VisitationTypes=k;g.VisitNodes=function(b,h,c){var d,e=null;if(c==k.AllNodes)d=f.FirstNode,c=f.NextNode;else if(c==k.PrevNodes)c=d=f.PrevNode;else if(c==k.NextNodes)c=d=f.NextNode;else if(c==k.ParentNodes)c=d=f.ParentNode;else if(c==k.SiblingNodes)d=f.FirstSibNode,c=f.NextSibNode;else if(c==k.PrevSibNodes)c=d=f.PrevSibNode;else if(c==k.NextSibNodes)c=d=f.NextSibNode;else if(c==
k.ChildNodes)d=f.FirstChildNode,c=f.NextSibNode,e=!0;else if(c==k.DecendentNodes)d=f.FirstChildNode,c=f.NextNode,e=!0;else throw Error("Unknown VisitationType ["+c+"].");for(d=a(b,d);d&&!(e&&d._hnIndent<=b._hnIndent)&&h.Visit(d);)d=a(d,c);return h};g.NullVisitor=function(){this.Visit=function(b){return!0}};g.CountingVisitor=function(){this.Count=0;this.Visit=function(b){this.Count++;return!0}};g.CollectingVisitor=function(){this.Nodes=[];this.Visit=function(b){this.Nodes.push(b);return!0}};g.IndexSelectorVisitor=
function(b){this.Index=b;this.Count=0;this.Node=null;this.Visit=function(b){this.Count++;return this.Count>this.Index?(this.Node=b,!1):!0}};g.PropertySearchVisitor=function(b,a){this.PropertySearchVisitor$PropertyName=b;this.PropertySearchVisitor$PropertyValue=a;this.Nodes=[];this.Visit=function(c){c[b]===a&&this.Nodes.push(c);return!0}};g.PropertySearchFirstVisitor=function(b,a){this.PropertySearchFirstVisitor$PropertyName=b;this.PropertySearchFirstVisitor$PropertyValue=a;this.Node=null;this.Visit=
function(c){return c[b]===a?(this.Node=c,!1):!0}};g.Link=function(b,a,c){if(b._hnPrevNode||b._hnNextNode)throw Error("This node is already linked.");b._hnPrevNode=a;b._hnNextNode=c;b._hnPrevNode&&(b._hnPrevNode._hnNextNode=b);b._hnNextNode&&(b._hnNextNode._hnPrevNode=b);return b};g.Unlink=h;g.AddChild=function(b,a,c){a=a?a:{};c=void 0===c?-1:c;a=HierNode(a);for(var d=b,h=b._hnNextNode;h;){if(h._hnIndent===b._hnIndent+1){if(!c)return a._hnIndent=b._hnIndent+1,a.Link(d,h),a;c--}else if(h._hnIndent<=
b._hnIndent)return a._hnIndent=b._hnIndent+1,a.Link(d,h),a;d=h;h=h._hnNextNode}a._hnIndent=b._hnIndent+1;a.Link(d,null);return a};g.RemoveChild=e;g.RemoveChildren=function(a){for(var h=[],c=e(a,0);c;)h.push(c),c=e(a,0);return h};g.TextGraph=function(a,h,c,d){c=void 0===c?"\t":c;d=void 0===d?"\n":d;for(var e=a[h],f=a._hnNextNode;f&&!(f._hnIndent<=a._hnIndent);){for(var e=e+d,g=1;g<=f._hnIndent-a._hnIndent;g++)e+=c;e+=f[h];f=f._hnNextNode}return e};return g}();
function HierNode(a){a=void 0===a?{}:a;HierNodeLib.InitNode(a);a.PrevNode=function(){return HierNodeLib.PrevNode(this)};a.NextNode=function(){return HierNodeLib.NextNode(this)};a.Indent=function(){return HierNodeLib.Indent(this)};a.FindRelative=function(a){return HierNodeLib.FindRelative(this,a)};a.FindFirst=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstNode)};a.FindLast=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.LastNode)};a.FindRoot=
function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.RootNode)};a.FindParent=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.ParentNode)};a.FindPrevSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.PrevSibNode)};a.FindNextSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.NextSibNode)};a.FindFirstSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstSibNode)};
a.FindLastSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.LastSibNode)};a.FindFirstChild=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstChildNode)};a.FindLastChild=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.LastChildNode)};a.FindFirstDescendent=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstDescNode)};a.FindLastDescendent=function(){return HierNodeLib.FindRelative(this,
HierNodeLib.RelationshipTypes.LastDescNode)};a.VisitNodes=function(a,e){return HierNodeLib.VisitNodes(this,a,e)};a.VisitAll=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.PrevNodes)};a.VisitPrevious=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.PrevNodes)};a.VisitNext=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.NextNodes)};a.VisitParents=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.ParentNodes)};
a.VisitSiblings=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.SiblingNodes)};a.VisitPreviousSiblings=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.PrevSibNodes)};a.VisitNextSiblings=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.NextSibNodes)};a.VisitChildren=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.ChildNodes)};a.VisitDescendents=function(a){return HierNodeLib.VisitNodes(this,
a,HierNodeLib.VisitationTypes.DecendentNodes)};a.ChildCount=function(){return HierNodeLib.VisitNodes(this,new HierNodeLib.CountingVisitor,HierNodeLib.VisitationTypes.ChildNodes).Count};a.Children=function(){return HierNodeLib.VisitNodes(this,new HierNodeLib.CollectingVisitor,HierNodeLib.VisitationTypes.ChildNodes).Nodes};a.Child=function(a){return HierNodeLib.VisitNodes(this,new HierNodeLib.IndexSelectorVisitor(a),HierNodeLib.VisitationTypes.ChildNodes).Node};a.SearchChildren=function(a,e){return HierNodeLib.VisitNodes(this,
new HierNodeLib.PropertySearchVisitor(a,e),HierNodeLib.VisitationTypes.ChildNodes).Nodes};a.SearchFirstChild=function(a,e){return HierNodeLib.VisitNodes(this,new HierNodeLib.PropertySearchFirstVisitor(a,e),HierNodeLib.VisitationTypes.ChildNodes).Node};a.DescendentCount=function(){return HierNodeLib.VisitNodes(this,new HierNodeLib.CountingVisitor,HierNodeLib.VisitationTypes.DecendentNodes).Count};a.Descendents=function(){return HierNodeLib.VisitNodes(this,new HierNodeLib.CollectingVisitor,HierNodeLib.VisitationTypes.DecendentNodes).Nodes};
a.SearchDescendents=function(a,e){return HierNodeLib.VisitNodes(this,new HierNodeLib.PropertySearchVisitor(a,e),HierNodeLib.VisitationTypes.DecendentNodes).Nodes};a.SearchFirstDescendent=function(a,e){return HierNodeLib.VisitNodes(this,new HierNodeLib.PropertySearchFirstVisitor(a,e),HierNodeLib.VisitationTypes.DecendentNodes).Node};a.Link=function(a,e){return HierNodeLib.Link(this,a,e)};a.Unlink=function(){return HierNodeLib.Unlink(this)};a.AddChild=function(a,e){return HierNodeLib.AddChild(this,
void 0===a?null:a,void 0===e?-1:e)};a.RemoveChild=function(a){return HierNodeLib.RemoveChild(this,a)};a.RemoveChildren=function(){return HierNodeLib.RemoveChildren(this)};a.TextGraph=function(a,e,f){return HierNodeLib.TextGraph(this,a,void 0===e?"\t":e,void 0===f?"\n":f)};return a}function TextNode(a){a=HierNode({Text:void 0===a?"":a});a.AddChildText=function(a,e){e=void 0===e?-1:e;return HierNodeLib.AddChild(this,TextNode(void 0===a?"":a),e)};return a}
window&&(window.HierNodeLib=HierNodeLib,window.HierNode=HierNode,window.TextNode=TextNode);
