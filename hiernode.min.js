var HierNodeLib=function(){function a(c,k){for(var b=c._hnPrevNode,d=c._hnNextNode,a=c,g=c,f=null;;){if(k===e.PrevNode)return c._hnPrevNode;if(k===e.NextNode)return c._hnNextNode;if(k===e.FirstNode){if(null===b)return c;if(null===b._hnPrevNode)return b;b=b._hnPrevNode}else if(k===e.LastNode){if(null===d)return c;if(null===d._hnNextNode)return d;d=d._hnNextNode}else if(k===e.RootNode){if(null===b)return a;b._hnIndent<a._hnIndent&&(a=b);b=b._hnPrevNode}else if(k===e.ParentNode){if(null===b)break;if(b._hnIndent<
c._hnIndent)return b;b=b._hnPrevNode}else if(k===e.PrevSibNode){if(null===b)break;if(b._hnIndent<c._hnIndent)break;if(b._hnIndent===c._hnIndent)return b;b=b._hnPrevNode}else if(k===e.NextSibNode){if(null===d)break;if(d._hnIndent<c._hnIndent)break;if(d._hnIndent===c._hnIndent)return d;d=d._hnNextNode}else if(k===e.FirstSibNode){if(null===b||b._hnIndent<c._hnIndent)return g;b._hnIndent===c._hnIndent&&(g=b);b=b._hnPrevNode}else if(k===e.LastSibNode){if(null===d||d._hnIndent<c._hnIndent)return g;d._hnIndent===
c._hnIndent&&(g=d);d=d._hnNextNode}else if(k===e.FirstChildNode){if(null===d)break;if(d._hnIndent<=c._hnIndent)break;if(d._hnIndent===c._hnIndent+1)return d;d=d._hnNextNode}else if(k===e.LastChildNode){if(null===d||d._hnIndent<=c._hnIndent)return f;d._hnIndent===c._hnIndent+1&&(f=d);d=d._hnNextNode}else if(k===e.FirstDescNode){if(d&&d._hnIndent>c._hnIndent)return d;break}else if(k===e.LastDescNode){if(null===d||d._hnIndent<=c._hnIndent)return f;d._hnIndent>c._hnIndent&&(f=d);d=d._hnNextNode}else break}return null}
function g(c){var a=c._hnPrevNode,b=c._hnNextNode;c._hnPrevNode=null;c._hnNextNode=null;a&&(a._hnNextNode=b);b&&(b._hnPrevNode=a);return c}function f(c,a){var b=HierNodeLib.VisitNodes(c,new HierNodeLib.IndexSelectorVisitor(a),HierNodeLib.VisitationTypes.ChildNodes).Node;b&&g(b);return b}var e={PrevNode:"PrevNode",NextNode:"NextNode",FirstNode:"FirstNode",LastNode:"LastNode",RootNode:"RootNode",ParentNode:"ParentNode",PrevSibNode:"PrevSibNode",NextSibNode:"NextSibNode",FirstSibNode:"FirstSibNode",
LastSibNode:"LastSibNode",FirstChildNode:"FirstChildNode",LastChildNode:"LastChildNode",FirstDescNode:"FirstDescNode",LastDescNode:"LastDescNode"},l={AllNodes:"AllNodes",PrevNodes:"PrevNodes",NextNodes:"NextNodes",ParentNodes:"ParentNodes",SiblingNodes:"SiblingNodes",PrevSibNodes:"PrevSibNodes",NextSibNodes:"NextSibNodes",ChildNodes:"ChildNodes",DecendentNodes:"DecendentNodes"},h={InitNode:function(c,a,b,d){c._hnPrevNode=void 0===a?null:a;c._hnNextNode=void 0===b?null:b;c._hnIndent=void 0===d?0:d;
return c},PrevNode:function(c){return c._hnPrevNode},NextNode:function(c){return c._hnNextNode},Indent:function(c){return c._hnIndent}};h.RelationshipTypes=e;h.FindRelative=a;h.VisitationTypes=l;h.VisitNodes=function(c,k,b){var d,g=null;if(b==l.AllNodes)d=e.FirstNode,b=e.NextNode;else if(b==l.PrevNodes)b=d=e.PrevNode;else if(b==l.NextNodes)b=d=e.NextNode;else if(b==l.ParentNodes)b=d=e.ParentNode;else if(b==l.SiblingNodes)d=e.FirstSibNode,b=e.NextSibNode;else if(b==l.PrevSibNodes)b=d=e.PrevSibNode;
else if(b==l.NextSibNodes)b=d=e.NextSibNode;else if(b==l.ChildNodes)d=e.FirstChildNode,b=e.NextSibNode,g=!0;else if(b==l.DecendentNodes)d=e.FirstChildNode,b=e.NextNode,g=!0;else throw Error("Unknown VisitationType ["+b+"].");for(d=a(c,d);d&&!(g&&d._hnIndent<=c._hnIndent)&&k.Visit(d);)d=a(d,b);return k};h.NullVisitor=function(){this.Visit=function(c){return!0}};h.CountingVisitor=function(){this.Count=0;this.Visit=function(c){this.Count++;return!0}};h.CollectingVisitor=function(){this.Nodes=[];this.Visit=
function(c){this.Nodes.push(c);return!0}};h.IndexSelectorVisitor=function(c){this.Index=c;this.Count=0;this.Node=null;this.Visit=function(c){this.Count++;return this.Count>this.Index?(this.Node=c,!1):!0}};h.PropertySearchVisitor=function(c,a){this.PropertySearchVisitor$PropertyName=c;this.PropertySearchVisitor$PropertyValue=a;this.Nodes=[];this.Visit=function(b){b[c]===a&&this.Nodes.push(b);return!0}};h.PropertySearchFirstVisitor=function(c,a){this.PropertySearchFirstVisitor$PropertyName=c;this.PropertySearchFirstVisitor$PropertyValue=
a;this.Node=null;this.Visit=function(b){return b[c]===a?(this.Node=b,!1):!0}};h.Link=function(c,a,b){if(c._hnPrevNode||c._hnNextNode)throw Error("This node is already linked.");c._hnPrevNode=a;c._hnNextNode=b;c._hnPrevNode&&(c._hnPrevNode._hnNextNode=c);c._hnNextNode&&(c._hnNextNode._hnPrevNode=c);return c};h.Unlink=g;h.AddChild=function(c,a,b){a=void 0===a?{}:a;b=void 0===b?-1:b;a=HierNode(a);for(var d=c,g=c._hnNextNode;g;){if(g._hnIndent===c._hnIndent+1){if(0===b)return a._hnIndent=c._hnIndent+
1,a.Link(d,g),a;b--}else if(g._hnIndent<=c._hnIndent)return a._hnIndent=c._hnIndent+1,a.Link(d,g),a;d=g;g=g._hnNextNode}a._hnIndent=c._hnIndent+1;a.Link(d,null);return a};h.RemoveChild=f;h.ClearChildren=function(a){for(var g=[],b=f(a,0);b;)g.push(b),b=f(a,0);return g};h.TextGraph=function(a,g,b,d){b=void 0===b?"\t":b;d=void 0===d?"\n":d;for(var e=a[g],f=a._hnNextNode;f&&!(f._hnIndent<=a._hnIndent);){for(var e=e+d,h=1;h<=f._hnIndent-a._hnIndent;h++)e+=b;e+=f[g];f=f._hnNextNode}return e};return h}();
function HierNode(a){a=void 0===a?{}:a;HierNodeLib.InitNode(a);a.PrevNode=function(){return HierNodeLib.PrevNode(this)};a.NextNode=function(){return HierNodeLib.NextNode(this)};a.Indent=function(){return HierNodeLib.Indent(this)};a.FindRelative=function(a){return HierNodeLib.FindRelative(this,a)};a.FindFirst=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstNode)};a.FindLast=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.LastNode)};a.FindRoot=
function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.RootNode)};a.FindParent=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.ParentNode)};a.FindPrevSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.PrevSibNode)};a.FindNextSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.NextSibNode)};a.FindFirstSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstSibNode)};
a.FindLastSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.LastSibNode)};a.FindFirstChild=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstChildNode)};a.FindLastChild=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.LastChildNode)};a.FindFirstDescendent=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstDescNode)};a.FindLastDescendent=function(){return HierNodeLib.FindRelative(this,
HierNodeLib.RelationshipTypes.LastDescNode)};a.VisitNodes=function(a,f){return HierNodeLib.VisitNodes(this,a,f)};a.VisitAll=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.PrevNodes)};a.VisitPrevious=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.PrevNodes)};a.VisitNext=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.NextNodes)};a.VisitParents=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.ParentNodes)};
a.VisitSiblings=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.SiblingNodes)};a.VisitPreviousSiblings=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.PrevSibNodes)};a.VisitNextSiblings=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.NextSibNodes)};a.VisitChildren=function(a){return HierNodeLib.VisitNodes(this,a,HierNodeLib.VisitationTypes.ChildNodes)};a.VisitDescendents=function(a){return HierNodeLib.VisitNodes(this,
a,HierNodeLib.VisitationTypes.DecendentNodes)};a.ChildCount=function(){return HierNodeLib.VisitNodes(this,new HierNodeLib.CountingVisitor,HierNodeLib.VisitationTypes.ChildNodes).Count};a.Children=function(){return HierNodeLib.VisitNodes(this,new HierNodeLib.CollectingVisitor,HierNodeLib.VisitationTypes.ChildNodes).Nodes};a.Child=function(a){return HierNodeLib.VisitNodes(this,new HierNodeLib.IndexSelectorVisitor(a),HierNodeLib.VisitationTypes.ChildNodes).Node};a.SearchChildren=function(a,f){return HierNodeLib.VisitNodes(this,
new HierNodeLib.PropertySearchVisitor(a,f),HierNodeLib.VisitationTypes.ChildNodes).Nodes};a.DescendentCount=function(){return HierNodeLib.VisitNodes(this,new HierNodeLib.CountingVisitor,HierNodeLib.VisitationTypes.DecendentNodes).Count};a.Descendents=function(){return HierNodeLib.VisitNodes(this,new HierNodeLib.CollectingVisitor,HierNodeLib.VisitationTypes.DecendentNodes).Nodes};a.SearchDescendents=function(a,f){return HierNodeLib.VisitNodes(this,new HierNodeLib.PropertySearchVisitor(a,f),HierNodeLib.VisitationTypes.DecendentNodes).Nodes};
a.Link=function(a,f){return HierNodeLib.Link(this,a,f)};a.Unlink=function(){return HierNodeLib.Unlink(this)};a.AddChild=function(a,f){return HierNodeLib.AddChild(this,void 0===a?null:a,void 0===f?-1:f)};a.RemoveChild=function(a){return HierNodeLib.RemoveChild(this,a)};a.ClearChildren=function(){return HierNodeLib.ClearChildren(this)};a.TextGraph=function(a,f,e){return HierNodeLib.TextGraph(this,a,void 0===f?"\t":f,void 0===e?"\n":e)};return a}
function TextNode(a){a=HierNode({Text:void 0===a?"":a});a.AddChildText=function(a,f){f=void 0===f?-1:f;return HierNodeLib.AddChild(this,TextNode(void 0===a?"":a),f)};return a}window&&(window.HierNodeLib=HierNodeLib,window.HierNode=HierNode,window.TextNode=TextNode);
