var HierNodeLib=function(){function a(d,c){for(var b=d._hnPrevNode,a=d._hnNextNode,h=d,e=d,g=null;;){if(c===f.PrevNode)return d._hnPrevNode;if(c===f.NextNode)return d._hnNextNode;if(c===f.FirstNode){if(null===b)return d;if(null===b._hnPrevNode)return b;b=b._hnPrevNode}else if(c===f.LastNode){if(null===a)return d;if(null===a._hnNextNode)return a;a=a._hnNextNode}else if(c===f.RootNode){if(null===b)return h;b._hnIndent<h._hnIndent&&(h=b);b=b._hnPrevNode}else if(c===f.ParentNode){if(null===b)break;if(b._hnIndent<
d._hnIndent)return b;b=b._hnPrevNode}else if(c===f.PrevSibNode){if(null===b)break;if(b._hnIndent<d._hnIndent)break;if(b._hnIndent===d._hnIndent)return b;b=b._hnPrevNode}else if(c===f.NextSibNode){if(null===a)break;if(a._hnIndent<d._hnIndent)break;if(a._hnIndent===d._hnIndent)return a;a=a._hnNextNode}else if(c===f.FirstSibNode){if(null===b||b._hnIndent<d._hnIndent)return e;b._hnIndent===d._hnIndent&&(e=b);b=b._hnPrevNode}else if(c===f.LastSibNode){if(null===a||a._hnIndent<d._hnIndent)return e;a._hnIndent===
d._hnIndent&&(e=a);a=a._hnNextNode}else if(c===f.FirstChildNode){if(null===a)break;if(a._hnIndent<=d._hnIndent)break;if(a._hnIndent===d._hnIndent+1)return a;a=a._hnNextNode}else if(c===f.LastChildNode){if(null===a||a._hnIndent<=d._hnIndent)return g;a._hnIndent===d._hnIndent+1&&(g=a);a=a._hnNextNode}else if(c===f.FirstDescNode){if(a&&a._hnIndent>d._hnIndent)return a;break}else if(c===f.LastDescNode){if(null===a||a._hnIndent<=d._hnIndent)return g;a._hnIndent>d._hnIndent&&(g=a);a=a._hnNextNode}else break}return null}
function h(d,c){if(0>c)return null;for(var b=a(d,f.FirstChildNode);b;){if(0===c)return b;c--;b=a(b,f.NextSibNode)}return null}function g(){this.Count=0;this.Visit=function(d){this.Count++;return!0}}function k(){this.Nodes=[];this.Visit=function(d){this.Nodes.push(d);return!0}}function l(d,c){for(var b=a(d,f.FirstChildNode);b&&c.Visit(b);)b=a(b,f.NextSibNode);return c}function m(d,c){for(var b=a(d,f.FirstChildNode);b&&!(b._hnIndent<=d._hnIndent)&&c.Visit(b);)b=a(b,f.NextNode);return c}function p(d){var a=
d._hnPrevNode,b=d._hnNextNode;d._hnPrevNode=null;d._hnNextNode=null;a&&(a._hnNextNode=b);b&&(b._hnPrevNode=a);return d}function n(a,c){var b=h(a,c);b&&p(b);return b}var f={PrevNode:"PrevNode",NextNode:"NextNode",FirstNode:"FirstNode",LastNode:"LastNode",RootNode:"RootNode",ParentNode:"ParentNode",PrevSibNode:"PrevSibNode",NextSibNode:"NextSibNode",FirstSibNode:"FirstSibNode",LastSibNode:"LastSibNode",FirstChildNode:"FirstChildNode",LastChildNode:"LastChildNode",FirstDescNode:"FirstDescNode",LastDescNode:"LastDescNode"},
e={InitNode:function(a,c,b,h){a._hnPrevNode=void 0===c?null:c;a._hnNextNode=void 0===b?null:b;a._hnIndent=void 0===h?0:h;return a},PrevNode:function(a){return a._hnPrevNode},NextNode:function(a){return a._hnNextNode},Indent:function(a){return a._hnIndent}};e.RelationshipTypes=f;e.FindRelative=a;e.FindChild=h;e.NullVisitor=function(){this.Visit=function(a){return!0}};e.CountingVisitor=g;e.CollectingVisitor=k;e.PropertySearchVisitor=function(a,c){this.PropertySearchVisitor$PropertyName=a;this.PropertySearchVisitor$PropertyValue=
c;this.Nodes=[];this.Visit=function(b){b[a]===c&&this.Nodes.push(b);return!0}};e.PropertySearchFirstVisitor=function(a,c){this.PropertySearchFirstVisitor$PropertyName=a;this.PropertySearchFirstVisitor$PropertyValue=c;this.PropertySearchFirstVisitor$Node=null;this.Visit=function(b){return b[a]===c?(this.PropertySearchFirstVisitor$Node=b,!1):!0}};e.VisitPrevious=function(d,c){for(var b=a(d,f.PrevNode);b&&c.Visit(b);)b=a(b,f.PrevNode);return c};e.VisitNext=function(d,c){for(var b=a(d,f.NextNode);b&&
c.Visit(b);)b=a(b,f.NextNode);return c};e.VisitParents=function(d,c){for(var b=a(d,f.ParentNode);b&&c.Visit(b);)b=a(b,f.ParentNode);return c};e.VisitPreviousSiblings=function(d,c){for(var b=a(d,f.PrevSibNode);b&&c.Visit(b);)b=a(b,f.PrevSibNode);return c};e.VisitNextSiblings=function(d,c){for(var b=a(d,f.NextSibNode);b&&c.Visit(b);)b=a(b,f.NextSibNode);return c};e.VisitChildren=l;e.ChildCount=function(a){return l(a,new g).Count};e.Children=function(a){return l(a,new k).Nodes};e.VisitDescendentsDepthFirst=
m;e.VisitDescendentsBreadthFirst=function(a,c){throw Error("Not implemented.");};e.DescendentCount=function(a){return m(a,new g).Count};e.Descendents=function(a){return m(a,new k).Nodes};e.Link=function(a,c,b){if(a._hnPrevNode||a._hnNextNode)throw Error("This node is already linked.");a._hnPrevNode=c;a._hnNextNode=b;a._hnPrevNode&&(a._hnPrevNode._hnNextNode=a);a._hnNextNode&&(a._hnNextNode._hnPrevNode=a);return a};e.Unlink=p;e.AddChild=function(a,c,b){c=void 0===c?{}:c;b=void 0===b?-1:b;c=HierNode(c);
for(var h=a,e=a._hnNextNode;e;){if(e._hnIndent===a._hnIndent+1){if(0===b)return c._hnIndent=a._hnIndent+1,c.Link(h,e),c;b--}else if(e._hnIndent<=a._hnIndent)return c._hnIndent=a._hnIndent+1,c.Link(h,e),c;h=e;e=e._hnNextNode}c._hnIndent=a._hnIndent+1;c.Link(h,null);return c};e.RemoveChild=n;e.ClearChildren=function(a){for(var c=[],b=n(a,0);b;)c.push(b),b=n(a,0);return c};e.TextGraph=function(a,c,b,h){b=void 0===b?"\t":b;h=void 0===h?"\n":h;for(var e=a[c],f=a._hnNextNode;f&&!(f._hnIndent<=a._hnIndent);){for(var e=
e+h,g=1;g<=f._hnIndent-a._hnIndent;g++)e+=b;e+=f[c];f=f._hnNextNode}return e};return e}();
function HierNode(a){a=void 0===a?{}:a;HierNodeLib.InitNode(a);a.PrevNode=function(){return HierNodeLib.PrevNode(this)};a.NextNode=function(){return HierNodeLib.NextNode(this)};a.Indent=function(){return HierNodeLib.Indent(this)};a.FindRelative=function(a){return HierNodeLib.FindRelative(this,a)};a.FindFirst=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstNode)};a.FindLast=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.LastNode)};a.FindRoot=
function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.RootNode)};a.FindParent=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.ParentNode)};a.FindPrevSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.PrevSibNode)};a.FindNextSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.NextSibNode)};a.FindFirstSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstSibNode)};
a.FindLastSibling=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.LastSibNode)};a.FindFirstChild=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstChildNode)};a.FindLastChild=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.LastChildNode)};a.FindFirstDescendent=function(){return HierNodeLib.FindRelative(this,HierNodeLib.RelationshipTypes.FirstDescNode)};a.FindLastDescendent=function(){return HierNodeLib.FindRelative(this,
HierNodeLib.RelationshipTypes.LastDescNode)};a.FindChild=function(a){return HierNodeLib.FindChild(this,a)};a.VisitPrevious=function(a){return HierNodeLib.VisitPrevious(this,a)};a.VisitNext=function(a){return HierNodeLib.VisitNext(this,a)};a.VisitParents=function(a){return HierNodeLib.VisitParents(this,a)};a.VisitPreviousSiblings=function(a){return HierNodeLib.VisitPreviousSiblings(this,a)};a.VisitNextSiblings=function(a){return HierNodeLib.VisitNextSiblings(this,a)};a.VisitChildren=function(a){return HierNodeLib.VisitChildren(this,
a)};a.ChildCount=function(){return HierNodeLib.ChildCount(this)};a.Children=function(){return HierNodeLib.Children(this)};a.SearchChildren=function(a,g){return HierNodeLib.VisitChildren(this,new HierNodeLib.PropertySearchVisitor(a,g)).Nodes};a.VisitDescendentsDepthFirst=function(a){return HierNodeLib.VisitDescendentsDepthFirst(this,a)};a.VisitDescendentsBreadthFirst=function(a){return HierNodeLib.VisitDescendentsBreadthFirst(this,a)};a.DescendentCount=function(){return HierNodeLib.DescendentCount(this)};
a.Descendents=function(){return HierNodeLib.Descendents(this)};a.SearchDescendents=function(a,g){return HierNodeLib.VisitDescendentsDepthFirst(this,new HierNodeLib.PropertySearchVisitor(a,g)).Nodes};a.Link=function(a,g){return HierNodeLib.Link(this,a,g)};a.Unlink=function(){return HierNodeLib.Unlink(this)};a.AddChild=function(a,g){return HierNodeLib.AddChild(this,void 0===a?null:a,void 0===g?-1:g)};a.RemoveChild=function(a){return HierNodeLib.RemoveChild(this,a)};a.ClearChildren=function(){return HierNodeLib.ClearChildren(this)};
a.TextGraph=function(a,g,k){return HierNodeLib.TextGraph(this,a,void 0===g?"\t":g,void 0===k?"\n":k)};return a}function TextNode(a){a=HierNode({Text:void 0===a?"":a});a.AddChildText=function(a,g){g=void 0===g?-1:g;return HierNodeLib.AddChild(this,TextNode(void 0===a?"":a),g)};return a}window&&(window.HierNodeLib=HierNodeLib,window.HierNode=HierNode,window.TextNode=TextNode);
